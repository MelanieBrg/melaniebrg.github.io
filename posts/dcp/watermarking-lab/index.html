<!doctype html><html lang=en><head><title>Spread Spectrum Watermarking Lab</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.5b7777e57c70f92a6339db87ad8b77d43266b3f01b9b591a1fac1f495003fb3c.css integrity="sha256-W3d35Xxw+SpjOduHrYt31DJms/Abm1kaH6wfSVAD+zw="><link rel=icon type=image/png href=/images/site/favicon_hubf9610573be7092a162e37ce4e9ddc7f_445_42x0_resize_box_3.png><meta property="og:title" content="Spread Spectrum Watermarking Lab"><meta property="og:description" content="Lab"><meta property="og:type" content="article"><meta property="og:url" content="https://melaniebrg.github.io/posts/dcp/watermarking-lab/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-27T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-27T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spread Spectrum Watermarking Lab"><meta name=twitter:description content="Lab"><meta name=description content="Lab"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu0e05227e23cc63e0456167155dcafe0f_7555_42x0_resize_box_3.png alt=Logo>
Mélanie's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu0e05227e23cc63e0456167155dcafe0f_7555_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu5d28afd3e8a4d26451a47582e9d04c66_7859_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/introduction/ title=Introduction>Introduction</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cg/> Computer Graphics</a><ul><li><a href=/posts/cg/blender-project/ title="Guitar blender">Guitar blender</a></li><li><a href=/posts/cg/unity-project/ title="Unity 3D platform game">Unity 3D platform game</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/hci/> Human Computer Interaction</a><ul><li><a href=/posts/hci/blog-creation/ title="Portfolio Set up">Portfolio Set up</a></li><li><a href=/posts/hci/affordance/ title="Affordance in daily life">Affordance in daily life</a></li><li><a href=/posts/hci/futur/ title="Enhancing human habilities AR">Enhancing human habilities AR</a></li><li><a href=/posts/hci/failed_input/ title="Interaction Paradigms">Interaction Paradigms</a></li><li><a href=/posts/hci/simple-unity-project/ title="Roller Ball Game">Roller Ball Game</a></li><li><a href=/posts/hci/current/ title="The shape of smartphones">The shape of smartphones</a></li><li><a href=/posts/hci/ultimate_display/ title="The Ultimate Display">The Ultimate Display</a></li><li><a href=/posts/hci/ubiquitous/ title="Ubiquitous Computing">Ubiquitous Computing</a></li><li><a href=/posts/hci/unity-install/ title="Unity installation">Unity installation</a></li><li><a href=/posts/hci/researcher/ title="Researcher presentation">Researcher presentation</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/dcp/> Content Protection</a><ul class=active><li><a href=/posts/dcp/encryption-lab/ title="Encryption & Stegano">Encryption & Stegano</a></li><li><a href=/posts/dcp/filtering-lab/ title="Image filtering">Image filtering</a></li><li><a class=active href=/posts/dcp/watermarking-lab/ title=Watermarking>Watermarking</a></li><li><a href=/posts/dcp/blockchain-project/ title="Blockchain project">Blockchain project</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/dcp/watermarking-lab/front.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/me_hu5d44f459cdbb0b50dd8623eab8fd0767_845857_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Mélanie Brégou</h5><p>Friday, October 27, 2023</p></div><div class=title><h1>Spread Spectrum Watermarking Lab</h1></div><div class=taxonomy-terms><ul style=padding-left:0></ul></div><div class=post-content id=post-content><table><thead><tr><th>Name</th><th>Course</th><th>Date</th></tr></thead><tbody><tr><td>Mélanie Brégou</td><td>Digital content protection</td><td>27/10/2023</td></tr></tbody></table><p><strong>Objective :</strong> Implement a spread spectrum watermarking method, with a focus on utilizing off-the-shelf random number generators, understanding the principles of uniform and Gaussian distributed generators, exploring correlation functions, and applying these concepts towards CDMA-based watermarking.</p><h3 id=table-of-contents>Table of Contents</h3><ul><li><a href=#off-the-shelf-random-number-generators>Off-the-Shelf Random Number Generators</a><ul><li><a href=#principles>Principles</a></li><li><a href=#uniform-distributed-generators>Uniform Distributed Generator</a></li><li><a href=###Gaussian-Distributed-Generators>Gaussian Distributed Generator</a></li></ul></li><li><a href=#correlation-functions>Correlation Functions</a><ul><li><a href=#graphical-representation-and-properties>Graphical Representation and Properties</a><ul><li><a href=#temporal-autocorrelation-function>Temporal Autocorrelation Function</a></li><li><a href=#cross-correlation-function>Cross-Correlation Function</a></li></ul></li><li><a href=#towards-cdma>Towards CDMA</a><ul><li><a href=#study-the-robustness-against-noise-addition>Study the robustness against noise addition</a></li></ul></li></ul></li><li><a href=#cdma-based-watermarking>CDMA-Based Watermarking</a></li></ul><h2 id=off-the-shelf-random-number-generators>Off-the-Shelf Random Number Generators</h2><h3 id=principles>Principles</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span></code></pre></div><p>We define the LCG (linear congruential generator) function : xn = (a * xn-1 + b) mod c,</p><ul><li>where a, b, c are positive integers</li><li>c can be a prime number, a &lt; c, b &lt; c</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>LCG</span>(x0,a,b,c):
</span></span><span style=display:flex><span>    list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    x <span style=color:#f92672>=</span> x0
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>c):  
</span></span><span style=display:flex><span>        list<span style=color:#f92672>.</span>append((a<span style=color:#f92672>*</span>x <span style=color:#f92672>+</span> b) <span style=color:#f92672>%</span> c)
</span></span><span style=display:flex><span>        x<span style=color:#f92672>=</span> (a<span style=color:#f92672>*</span>x <span style=color:#f92672>+</span> b) <span style=color:#f92672>%</span> c
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>Xn</span>(x0,a,b,c,T):
</span></span><span style=display:flex><span>    x1 <span style=color:#f92672>=</span> (a<span style=color:#f92672>*</span>x0 <span style=color:#f92672>+</span> b) <span style=color:#f92672>%</span> c
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Xn(x1,a,b,c,T<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>if</span> T<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> x1
</span></span></code></pre></div><p>Let&rsquo;s generate a random sequence following the LCG rule, for the following parameters: a = 3, b = 5, c = 19 and x0 = 3</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(LCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>19</span>))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#34;x0=3,a=3,b=5,c=19&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_9_0.png alt=png></p><p>This parameter combination leads to repetitive sequences, resulting in patterns in the plot rather than true randomness.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(LCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>19</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=7,a=3,b=5,c=19&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(LCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>19</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=3,a=3,b=7,c=19&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>plot(LCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>19</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=3,a=7,b=5,c=19&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>.</span>plot(LCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=3,a=3,b=5,c=15&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'x0=3,a=3,b=5,c=15')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_11_1.png alt=png></p><p>Repeating the example for:</p><ul><li>c = 19, a = 3, b = 5, and x0 = 7</li><li>c = 19, a = 3, b = 7, and x0 = 3</li><li>c = 19, a = 7, b = 5, and x0 = 3</li><li>c = 15, a = 3, b = 5, and x0 = 3</li></ul><p>The generated plots are still repetitive sequences.</p><p>Now let&rsquo;s repeat the example for the MLCG (Multiple LCG), described by xn = (a * xn-1 + b * xn-2 + c) mod d, where a, b, c, d are positive integers and d can be a prime number, a &lt; d, b &lt; d, c &lt; d</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>MLCG</span>(x0,x1, a,b,c,d):
</span></span><span style=display:flex><span>    list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    xn <span style=color:#f92672>=</span> x0
</span></span><span style=display:flex><span>    xn1 <span style=color:#f92672>=</span> x1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>d):  
</span></span><span style=display:flex><span>        list<span style=color:#f92672>.</span>append((a<span style=color:#f92672>*</span>xn1 <span style=color:#f92672>+</span> b<span style=color:#f92672>*</span>xn <span style=color:#f92672>+</span> c) <span style=color:#f92672>%</span> d)
</span></span><span style=display:flex><span>        xn_ <span style=color:#f92672>=</span> xn
</span></span><span style=display:flex><span>        xn <span style=color:#f92672>=</span> xn1
</span></span><span style=display:flex><span>        xn1<span style=color:#f92672>=</span> (a<span style=color:#f92672>*</span>xn1 <span style=color:#f92672>+</span> b<span style=color:#f92672>*</span>xn_ <span style=color:#f92672>+</span> c) <span style=color:#f92672>%</span> d
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> list
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(MLCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>,x1<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>,d<span style=color:#f92672>=</span><span style=color:#ae81ff>31</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=7,x1=0,a=3,b=5,c=6,d=31&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(MLCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,x1<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>,d<span style=color:#f92672>=</span><span style=color:#ae81ff>31</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=3,x1=2,a=3,b=7,c=6,d=31&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>plot(MLCG(x0<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,x1<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>,a<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,b<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span>,c<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>,d<span style=color:#f92672>=</span><span style=color:#ae81ff>31</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;x0=3,x1=4,a=3,b=7,c=6,d=31&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'x0=3,x1=4,a=3,b=7,c=6,d=31')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_15_1.png alt=png></p><p>The generated sequences do not seem repetitive and appear to be random.</p><h3 id=uniform-distributed-generators>Uniform Distributed Generators</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>random_vector</span>(T):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [random<span style=color:#f92672>.</span>uniform(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> range(T)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>T<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> random_vector(T)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(x)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[0, 1] uniform generator with </span><span style=color:#e6db74>{</span>T<span style=color:#e6db74>}</span><span style=color:#e6db74> components&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;mean :&#34;</span>,np<span style=color:#f92672>.</span>mean(x))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;variance :&#34;</span>,np<span style=color:#f92672>.</span>var(x))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>hist(x, <span style=color:#ae81ff>15</span>, density<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[0, 1] uniform generator with </span><span style=color:#e6db74>{</span>T<span style=color:#e6db74>}</span><span style=color:#e6db74> components&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_18_0.png alt=png></p><pre><code>mean : 0.523604935218904
variance : 0.08380462274270617
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_18_2.png alt=png></p><p>The mean is approximately the theoretical mean of 0.5, which aligns with the uniform distribution in the range [0, 1]. The variance is also approximately as expected for a uniform distribution in [0, 1].
The more T is large the more uniform the sequence is.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print(<span style=color:#e6db74>&#34;x:&#34;</span>, x)
</span></span><span style=display:flex><span>a<span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>y1 <span style=color:#f92672>=</span> [a<span style=color:#f92672>*</span>xi <span style=color:#f92672>+</span> b <span style=color:#66d9ef>for</span> xi <span style=color:#f92672>in</span> x]
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;y1:&#34;</span>,y1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a<span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>y2 <span style=color:#f92672>=</span> [a<span style=color:#f92672>*</span>xi <span style=color:#f92672>+</span> b <span style=color:#66d9ef>for</span> xi <span style=color:#f92672>in</span> x]
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;y2:&#34;</span>,y2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(y1)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;y = x + 6&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(y2)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;y = 6x&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>mean y = x + 6:&#34;</span>,np<span style=color:#f92672>.</span>mean(y1))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;variance y = x + 6:&#34;</span>,np<span style=color:#f92672>.</span>var(y1))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>mean y = 6x :&#34;</span>,np<span style=color:#f92672>.</span>mean(y2))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;variance y = 6x:&#34;</span>,np<span style=color:#f92672>.</span>var(y2))
</span></span></code></pre></div><pre><code>x: [0.25837191659828673, 0.4470563921290477, 0.21382730728002808, 0.7086462073203836, 0.3705133398244411, 0.776530587035182, 0.6245249968295411, 0.6055792797378172, 0.20047566143197193, 0.7476917028832212, 0.007605557962887088, 0.6600414938252693, 0.7897935065863732, 0.8451555781774278, 0.46916100754285683, 0.29834856967908496, 0.15299829505332485, 0.7990704904514152, 0.7052788414120111, 0.43455085071476685, 0.41080882660183615, 0.8469856705920843, 0.17925364856258053, 0.597235407898144, 0.8894834971435803, 0.17677942597730867, 0.9017874629765549, 0.1391642452258447, 0.16908696917443422, 0.9687377617065794, 0.8558605812694794, 0.9672336228942946, 0.025345710253115716, 0.9368928428842539, 0.2841382877833384, 0.2676295593554707, 0.4483339344855558, 0.3112961811035514, 0.9842870866904126, 0.2429504222912039, 0.9534669885193416, 0.856102428315788, 0.11246021882927382, 0.6255693356389754, 0.0092892352608408, 0.3484323300025869, 0.5204459560633431, 0.4491732384806463, 0.7939177716387159, 0.6778219507997898, 0.25035108261802685, 0.6757293094523129, 0.3729853645172859, 0.17497848177504938, 0.7141314038388153, 0.9839656409272567, 0.6531845148593777, 0.4053919177857205, 0.9676795868041943, 0.3719787397880119, 0.3610795330975649, 0.4260508767361372, 0.27951603091395316, 0.04360423771126598, 0.785288125768064, 0.5039429430086181, 0.1382793843880049, 0.8461760019908358, 0.9147695729971356, 0.21423640538998656, 0.10539646167702355, 0.7953651908588297, 0.3264988721469524, 0.31319950539263697, 0.1657945694437255, 0.210725128993006, 0.6459855824939482, 0.610809529651901, 0.34482684476226844, 0.003863402465228094, 0.7105935752171066, 0.9348469122045779, 0.3340640165132659, 0.19298940842885515, 0.7449744847248124, 0.7317522404803241, 0.8992896601967665, 0.5586670660533961, 0.9212492669920598, 0.5922609334191495, 0.6794701791984561, 0.8624487424953742, 0.7555926452368393, 0.37518956356210553, 0.35120430225899457, 0.7273158434032417, 0.8574333485301392, 0.2783898505862623, 0.24347399882053722, 0.9383110604207417]
y1: [6.2583719165982865, 6.447056392129047, 6.213827307280028, 6.708646207320384, 6.370513339824441, 6.776530587035182, 6.624524996829541, 6.6055792797378174, 6.200475661431972, 6.7476917028832215, 6.007605557962887, 6.660041493825269, 6.789793506586373, 6.845155578177428, 6.469161007542857, 6.298348569679085, 6.152998295053325, 6.799070490451415, 6.705278841412011, 6.434550850714767, 6.410808826601836, 6.846985670592084, 6.179253648562581, 6.597235407898144, 6.88948349714358, 6.176779425977308, 6.9017874629765545, 6.139164245225845, 6.169086969174434, 6.9687377617065795, 6.8558605812694795, 6.967233622894295, 6.025345710253116, 6.936892842884254, 6.284138287783338, 6.267629559355471, 6.4483339344855555, 6.311296181103551, 6.984287086690412, 6.242950422291204, 6.953466988519342, 6.856102428315788, 6.112460218829273, 6.625569335638976, 6.009289235260841, 6.348432330002587, 6.520445956063343, 6.449173238480646, 6.793917771638716, 6.67782195079979, 6.250351082618026, 6.675729309452313, 6.372985364517286, 6.1749784817750495, 6.714131403838815, 6.983965640927257, 6.653184514859378, 6.40539191778572, 6.967679586804194, 6.371978739788012, 6.3610795330975645, 6.426050876736137, 6.279516030913953, 6.043604237711266, 6.785288125768064, 6.503942943008618, 6.138279384388005, 6.846176001990836, 6.914769572997136, 6.214236405389986, 6.1053964616770235, 6.7953651908588295, 6.326498872146953, 6.313199505392637, 6.165794569443726, 6.210725128993006, 6.645985582493948, 6.610809529651901, 6.344826844762268, 6.003863402465228, 6.710593575217107, 6.934846912204578, 6.334064016513266, 6.192989408428855, 6.744974484724812, 6.731752240480324, 6.899289660196766, 6.558667066053396, 6.92124926699206, 6.5922609334191495, 6.679470179198456, 6.862448742495374, 6.755592645236839, 6.375189563562105, 6.351204302258995, 6.727315843403241, 6.857433348530139, 6.2783898505862625, 6.243473998820537, 6.938311060420742]
y2: [1.5502314995897204, 2.682338352774286, 1.2829638436801685, 4.251877243922301, 2.2230800389466467, 4.659183522211092, 3.7471499809772464, 3.6334756784269033, 1.2028539685918316, 4.486150217299327, 0.04563334777732253, 3.960248962951616, 4.738761039518239, 5.070933469064567, 2.8149660452571412, 1.7900914180745098, 0.9179897703199491, 4.794422942708492, 4.231673048472067, 2.607305104288601, 2.464852959611017, 5.081914023552506, 1.0755218913754832, 3.5834124473888638, 5.336900982861482, 1.060676555863852, 5.410724777859329, 0.8349854713550682, 1.0145218150466053, 5.812426570239476, 5.135163487616876, 5.803401737365768, 0.1520742615186943, 5.621357057305524, 1.7048297267000303, 1.6057773561328244, 2.6900036069133346, 1.8677770866213084, 5.905722520142476, 1.4577025337472234, 5.72080193111605, 5.136614569894728, 0.6747613129756429, 3.753416013833853, 0.0557354115650448, 2.0905939800155213, 3.1226757363800584, 2.6950394308838774, 4.763506629832295, 4.066931704798739, 1.5021064957081611, 4.054375856713877, 2.2379121871037153, 1.0498708906502963, 4.284788423032892, 5.90379384556354, 3.919107089156266, 2.4323515067143227, 5.806077520825166, 2.2318724387280713, 2.1664771985853895, 2.5563052604168233, 1.677096185483719, 0.2616254262675959, 4.711728754608384, 3.0236576580517083, 0.8296763063280295, 5.0770560119450145, 5.488617437982813, 1.2854184323399194, 0.6323787700621413, 4.772191145152979, 1.9589932328817143, 1.8791970323558218, 0.994767416662353, 1.264350773958036, 3.8759134949636893, 3.664857177911406, 2.0689610685736106, 0.023180414791368564, 4.26356145130264, 5.609081473227468, 2.004384099079595, 1.1579364505731309, 4.469846908348875, 4.390513442881945, 5.395737961180599, 3.3520023963203767, 5.527495601952358, 3.5535656005148972, 4.076821075190736, 5.174692454972245, 4.533555871421036, 2.251137381372633, 2.1072258135539674, 4.36389506041945, 5.144600091180835, 1.6703391035175739, 1.4608439929232233, 5.62986636252445]

mean y = x + 6: 6.523604935218902
variance y = x + 6: 0.08380462274270613

mean y = 6x : 3.141629611313425
variance y = 6x: 3.016966418737421
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_20_1.png alt=png></p><p>On the left :</p><p>We apply a linear transformation with &lsquo;a = 1&rsquo; and &lsquo;b = 6&rsquo; to the vector x. This transformation shifts all values in x by adding 6.</p><p>The plot shows that each value in x has been shifted.</p><ul><li>Mean is the expected mean of x + 6.</li><li>Variance remains approximately the same as the variance of x.</li></ul><p>On the right :</p><p>We set &lsquo;a = 6&rsquo; and &lsquo;b = 0&rsquo;, which effectively scale all values in x by a factor of 6.</p><p>The plot demonstrates that all values in x have been multiplied by 6, causing a uniform stretch of the distribution.</p><ul><li>Mean is approximately 6 times the mean of x.</li><li>Variance is 6^2 times the variance of x.</li></ul><h3 id=gaussian-distributed-generators>Gaussian Distributed Generators</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>T<span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>gaussian <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,T)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(gaussian)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Gaussian Distribution Plot&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>hist(gaussian, <span style=color:#ae81ff>10</span>, density<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Histogram of Gaussian Distribution&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;mean :&#34;</span>,np<span style=color:#f92672>.</span>mean(gaussian))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;variance :&#34;</span>,np<span style=color:#f92672>.</span>var(gaussian))
</span></span></code></pre></div><pre><code>mean : 0.010568025096744142
variance : 0.012131041665992786
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_24_1.png alt=png></p><p>In this Gaussian distribution, the mean is close to zero, and the variance reflects the spread of the data around this central point both indicative of the characteristics of a typical Gaussian distribution. With a larger T, the mean would likely converge even closer to zero.</p><h2 id=correlation-functions>Correlation Functions</h2><p>In the domain of watermarking, autocorrelation functions are essential tools for quantifying the inherent randomness within a watermark and its correlation with the host signal. These functions are crucial for the security and resilience of embedded watermarks.</p><h3 id=graphical-representation-and-properties>Graphical Representation and Properties</h3><h4 id=temporal-autocorrelation-function>Temporal Autocorrelation Function</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>correlation <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x,x,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(correlation)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#34;Correlation&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_30_0.png alt=png></p><p>The central spike corresponds to the peak autocorrelation represents the self-similarity or self-correlation of the signal with itself when no time lag is introduced. This is a fundamental characteristic of any signal&rsquo;s autocorrelation function.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x_1000 <span style=color:#f92672>=</span> random_vector(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>x_10000 <span style=color:#f92672>=</span> random_vector(<span style=color:#ae81ff>10000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>correlation_1000 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_1000,x_1000,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>correlation_10000 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_10000,x_10000,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(correlation_1000)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Normal autocorrelation (1000)&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(correlation_10000)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Normal autocorrelation (10000)&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'Normal autocorrelation (10000)')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_32_1.png alt=png></p><p>As the sample size T increase, the central spike becomes narrower and taller, and the random fluctuations become less pronounced. This is because with a larger sample size, the estimate of the autocorrelation becomes more precise and approaches the theoretical expectations.</p><p>The random fluctuations away from the central spike suggest that the Gaussian signal is essentially uncorrelated with itself at different time lags.</p><h3 id=cross-correlation-function>Cross Correlation Function</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>gaussian_1000 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a<span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>z <span style=color:#f92672>=</span> [a<span style=color:#f92672>*</span>gauss<span style=color:#f92672>+</span> b <span style=color:#66d9ef>for</span> gauss <span style=color:#f92672>in</span> gaussian_1000]
</span></span><span style=display:flex><span>t <span style=color:#f92672>=</span> [a<span style=color:#f92672>*</span>gauss<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span> b <span style=color:#66d9ef>for</span> gauss <span style=color:#f92672>in</span> gaussian_1000]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>correlation_y1 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(z,z,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>correlation_y2 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(t,t,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(correlation_y1)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Autocorrelation z = 6x + 16 &#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(correlation_y2)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Autocorrelation t = 6x**2 + 16 &#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'Autocorrelation t = 6x**2 + 16 ')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_35_1.png alt=png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>correlation_gauss_z <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(gaussian_1000,z,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>correlation_gauss_t <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(gaussian_1000,t,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(correlation_gauss_z)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Correlation gaussian and z&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(correlation_gauss_t)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Correlation gaussian and t&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'Correlation gaussian and t')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_36_1.png alt=png></p><h3 id=towards-cdma>Towards CDMA</h3><h4 id=study-the-robustness-against-noise-addition>Study the robustness against noise addition</h4><p>In this section, we explore the robustness of correlation functions in the context of Code Division Multiple Access (CDMA) as we examine their behavior in the presence of noise.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>T <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>x_gauss_1 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,T)
</span></span><span style=display:flex><span>x_gauss_2 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,T)
</span></span><span style=display:flex><span>x_gauss_3 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,T)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>correlation <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_1,x_gauss_2,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(correlation)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#34;Correlation&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_40_0.png alt=png></p><p>The sets of Gaussian signals are largely uncorrelated.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>r1<span style=color:#f92672>=</span> [x_gauss_1[i] <span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span> x_gauss_3[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(T)]
</span></span><span style=display:flex><span>r2 <span style=color:#f92672>=</span> [x_gauss_1[i] <span style=color:#f92672>+</span> x_gauss_2[i] <span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span> x_gauss_3[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(T)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>correlation_gauss_r_x1 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_1,r1,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>correlation_gauss_r_x2 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_2,r1,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>correlation_gauss_r2_x1 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_1,r2,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>correlation_gauss_r2_x2 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_2,r2,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(correlation_gauss_r_x1)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Correlation gaussian1 and r = gaussian1 + alpha * gaussian 3 &#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(correlation_gauss_r_x2)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Correlation gaussian2 and r&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>plot(correlation_gauss_r2_x1)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Correlation gaussian1 and r2 = gaussian1 + gaussian2 + alpha * gaussian 3 &#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>plot(correlation_gauss_r2_x2)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Correlation gaussian2 and r2  &#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig<span style=color:#f92672>.</span>suptitle(<span style=color:#e6db74>&#34;Correlation with alpha = 1 and T = 1000&#34;</span>, fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 0.98, 'Correlation with alpha = 1 and T = 1000')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_42_1.png alt=png></p><p>On the up right there is no correlation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>T <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>x_gauss_1 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,T)
</span></span><span style=display:flex><span>x_gauss_2 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.1</span>,T)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>=</span> [x_gauss_1[i] <span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span> x_gauss_2[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(T)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>correlation_gauss_r <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_1,r,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(correlation_gauss_r)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#34;Correlation gauss (1000) and r = gauss1 + gauss2 &#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_44_0.png alt=png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>fig<span style=color:#f92672>.</span>suptitle(<span style=color:#e6db74>&#34;r = gauss1 + alpha * gauss2 with 1000 components&#34;</span>, fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alphas <span style=color:#f92672>=</span> [<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>64</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, alpha <span style=color:#f92672>in</span> enumerate(alphas): 
</span></span><span style=display:flex><span>    r<span style=color:#f92672>=</span> [x_gauss_1[i] <span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span> x_gauss_2[i] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(T)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    correlation_gauss_r <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_1,r,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>    axes[i]<span style=color:#f92672>.</span>plot(correlation_gauss_r)
</span></span><span style=display:flex><span>    axes[i]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;alpha = </span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_45_0.png alt=png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>x_gauss_1_100000 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.1</span>, <span style=color:#ae81ff>100000</span>)
</span></span><span style=display:flex><span>x_gauss_2_100000 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.1</span>, <span style=color:#ae81ff>100000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>T <span style=color:#f92672>=</span> <span style=color:#ae81ff>100000</span>
</span></span><span style=display:flex><span>r_gauss_100000 <span style=color:#f92672>=</span> [x_gauss_1_100000[j] <span style=color:#f92672>+</span> alpha <span style=color:#f92672>*</span> x_gauss_2_100000[j] <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(T)]
</span></span><span style=display:flex><span>fig2, axes2 <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>fig2<span style=color:#f92672>.</span>suptitle(<span style=color:#e6db74>&#34;r = gauss1 + alpha * gauss2 with 100000 components&#34;</span>, fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, alpha <span style=color:#f92672>in</span> enumerate(alphas):
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    correlation_gauss_r_100000 <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>correlate(x_gauss_1, r_gauss_100000, mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;full&#39;</span>)
</span></span><span style=display:flex><span>    axes2[i]<span style=color:#f92672>.</span>plot(correlation_gauss_r_100000)
</span></span><span style=display:flex><span>    axes2[i]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_46_0.png alt=png></p><p>The higher the alpha and the number of samples (T), the noisier the autocorrelation.</p><h2 id=cdma-based-watermarking>CDMA based watermarking</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> cv2
</span></span></code></pre></div><p>Firstly let&rsquo;s compute the DCT transform.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>imread(<span style=color:#e6db74>&#34;../TP-HTI/lena.jpg&#34;</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>lena_f <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>float32(lena)
</span></span><span style=display:flex><span>dct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>dct(lena_f)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>idct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>idct(dct_lena)
</span></span><span style=display:flex><span>idct_lena <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>uint8(idct_lena)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>imshow(lena, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Lena image&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>imshow(idct_lena, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Lena IDCT image&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ax <span style=color:#f92672>in</span> axes:
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>axis(<span style=color:#e6db74>&#39;off&#39;</span>)
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_51_0.png alt=png></p><p>The image obtained after IDCT is identical.</p><p>Now before applying IDCT, we generate a mark: a standard Gaussian noise sequence of 32x32 valus with m(1,1) = 0 and insert the mark according to the formula: niu_w = niu*(1+ alpha*m) where alpha is a scalar.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>niu <span style=color:#f92672>=</span> dct_lena[:<span style=color:#ae81ff>32</span>,:<span style=color:#ae81ff>32</span>]
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, (<span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>32</span>))
</span></span><span style=display:flex><span>niu_w <span style=color:#f92672>=</span> niu<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span>m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>imshow(niu, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;niu&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>imshow(niu_w, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;niu_w&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'niu_w')
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_54_1.png alt=png></p><p>Then, we perform the IDCT transform on the watermarked image.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>dct_lena[:<span style=color:#ae81ff>32</span>,:<span style=color:#ae81ff>32</span>] <span style=color:#f92672>=</span>  niu_w
</span></span><span style=display:flex><span>dct_lena[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> niu[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>idct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>idct(dct_lena)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>imshow(lena, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Lena image&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>imshow(idct_lena, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Lena IDCT watermarked image&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ax <span style=color:#f92672>in</span> axes:
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>axis(<span style=color:#e6db74>&#39;off&#39;</span>)
</span></span></code></pre></div><p><img src=notebook_tp3_files/notebook_tp3_56_0.png alt=png></p><p>With a value alpha=0.1 the PSNR is small. In order to have high image quality, let&rsquo;s write a function so that PSNR(lena, lena_mark) > 30 dB.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>watermark_lena</span>(alpha):
</span></span><span style=display:flex><span>    lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>imread(<span style=color:#e6db74>&#34;../TP-HTI/lena.jpg&#34;</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    lena_f <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>float32(lena)
</span></span><span style=display:flex><span>    dct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>dct(lena_f)
</span></span><span style=display:flex><span>    niu <span style=color:#f92672>=</span> dct_lena[:<span style=color:#ae81ff>32</span>,:<span style=color:#ae81ff>32</span>]
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, (<span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>32</span>))
</span></span><span style=display:flex><span>    niu_w <span style=color:#f92672>=</span> niu<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span>m)
</span></span><span style=display:flex><span>    dct_lena[:<span style=color:#ae81ff>32</span>,:<span style=color:#ae81ff>32</span>] <span style=color:#f92672>=</span>  niu_w
</span></span><span style=display:flex><span>    dct_lena[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> niu[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    idct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>idct(dct_lena)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> idct_lena, m 
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>idct_lena_w, m <span style=color:#f92672>=</span> watermark_lena(alpha)
</span></span><span style=display:flex><span>lena <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>float32(lena)
</span></span><span style=display:flex><span>psnr <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>PSNR(idct_lena, lena)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> psnr <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>30</span> :
</span></span><span style=display:flex><span>    alpha <span style=color:#f92672>=</span> alpha<span style=color:#f92672>/</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    idct_lena_w,m <span style=color:#f92672>=</span> watermark_lena(alpha)
</span></span><span style=display:flex><span>    psnr <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>PSNR(idct_lena_w, lena)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;PSNR final&#34;</span>,psnr)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Alpha final&#34;</span>,alpha)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>imshow(lena, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Lena image&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>imshow(idct_lena_w, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Lena IDCT watermarked image&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ax <span style=color:#f92672>in</span> axes:
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>axis(<span style=color:#e6db74>&#39;off&#39;</span>)
</span></span></code></pre></div><pre><code>PSNR final 46.59884513165156
Alpha final 0.01
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_58_1.png alt=png></p><p>The watermark is now imperceptible.</p><h4 id=detection-step>Detection step</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>watermark_detection</span>(lena,idct_lena_w, m, threshold<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>):
</span></span><span style=display:flex><span>    idct_lena_w_f <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>float32(idct_lena_w)
</span></span><span style=display:flex><span>    dct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>dct(idct_lena_w_f)
</span></span><span style=display:flex><span>    niu_w  <span style=color:#f92672>=</span> dct_lena[:<span style=color:#ae81ff>32</span>,:<span style=color:#ae81ff>32</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    niu <span style=color:#f92672>=</span> niu_w<span style=color:#f92672>/</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>+</span> alpha<span style=color:#f92672>*</span>m)
</span></span><span style=display:flex><span>    dct_lena[:<span style=color:#ae81ff>32</span>,:<span style=color:#ae81ff>32</span>] <span style=color:#f92672>=</span>  niu
</span></span><span style=display:flex><span>    dct_lena[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> niu[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    idct_lena <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>idct(dct_lena)
</span></span><span style=display:flex><span>    h, w <span style=color:#f92672>=</span> lena<span style=color:#f92672>.</span>shape
</span></span><span style=display:flex><span>    diff <span style=color:#f92672>=</span> cv2<span style=color:#f92672>.</span>subtract(lena, idct_lena)
</span></span><span style=display:flex><span>    err <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>sum(diff<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    mse <span style=color:#f92672>=</span> err<span style=color:#f92672>/</span>(float(h<span style=color:#f92672>*</span>w))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> mse <span style=color:#f92672>&lt;</span> threshold:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Detected&#34;</span>, mse
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Not Detected&#34;</span>, mse
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print(watermark_detection(lena,idct_lena_w, m ))
</span></span></code></pre></div><pre><code>('Detected', 1.0668644856437481e-09)
</code></pre><p>The mean squared error between Lena and the image, from which we removed the watermark &rsquo;m&rsquo; from its DCT, is almost 0, which is as expected, since this image is the one to which we added the watermark.</p><h4 id=robusteness-to-jpeg-compression>Robusteness to jpeg compression</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> PIL <span style=color:#f92672>import</span> Image
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> matplotlib <span style=color:#f92672>import</span> image
</span></span></code></pre></div><p>Firstly, let&rsquo;s save the watermarked in jpg with different quality factors (100, 99 and 75).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>idct_lena_w <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span>fromarray(idct_lena_w)
</span></span><span style=display:flex><span>idct_lena_w <span style=color:#f92672>=</span> idct_lena_w<span style=color:#f92672>.</span>convert(<span style=color:#e6db74>&#34;L&#34;</span>)
</span></span><span style=display:flex><span>idct_lena_w<span style=color:#f92672>.</span>save(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;./results/lena_w</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>_100.jpg&#39;</span>, optimize<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, quality<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>idct_lena_w<span style=color:#f92672>.</span>save(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;./results/lena_w</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>_99.jpg&#39;</span>, optimize<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, quality<span style=color:#f92672>=</span><span style=color:#ae81ff>99</span>)
</span></span><span style=display:flex><span>idct_lena_w<span style=color:#f92672>.</span>save(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;./results/lena_w</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>_75.jpg&#39;</span>, optimize<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, quality<span style=color:#f92672>=</span><span style=color:#ae81ff>75</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>lena_w_100 <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span>imread(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;./results/lena_w</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>_100.jpg&#34;</span>)
</span></span><span style=display:flex><span>lena_w_99 <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span>imread(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;./results/lena_w</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>_99.jpg&#34;</span>)
</span></span><span style=display:flex><span>lena_w_75 <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span>imread(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;./results/lena_w</span><span style=color:#e6db74>{</span>alpha<span style=color:#e6db74>}</span><span style=color:#e6db74>_75.jpg&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>imshow(lena_w_100, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Lena jpg image Q=100&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>imshow(lena_w_99, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Lena jpg image Q=99&#34;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>imshow(lena_w_75, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gray&#39;</span>)
</span></span><span style=display:flex><span>axes[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Lena jpg image Q=75&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(watermark_detection(lena,lena_w_100, m ))
</span></span><span style=display:flex><span>print(watermark_detection(lena,lena_w_99, m ))
</span></span><span style=display:flex><span>print(watermark_detection(lena,lena_w_75, m ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ax <span style=color:#f92672>in</span> axes:
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>axis(<span style=color:#e6db74>&#39;off&#39;</span>)
</span></span></code></pre></div><pre><code>('Detected', 0.3582899868488312)
('Detected', 0.37200385332107544)
('Not Detected', 10.26805305480957)
</code></pre><p><img src=notebook_tp3_files/notebook_tp3_68_1.png alt=png></p><p>Even if the visual difference is imperceptible, the watermark may not be detected based on the threshold we select, particularly for lower quality images.</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmelaniebrg.github.io%2fposts%2fdcp%2fwatermarking-lab%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fmelaniebrg.github.io%2fposts%2fdcp%2fwatermarking-lab%2f&text=Spread%20Spectrum%20Watermarking%20Lab&via=M%c3%a9lanie%27s%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fmelaniebrg.github.io%2fposts%2fdcp%2fwatermarking-lab%2f&title=Spread%20Spectrum%20Watermarking%20Lab" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fmelaniebrg.github.io%2fposts%2fdcp%2fwatermarking-lab%2f&title=Spread%20Spectrum%20Watermarking%20Lab" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Spread%20Spectrum%20Watermarking%20Lab https%3a%2f%2fmelaniebrg.github.io%2fposts%2fdcp%2fwatermarking-lab%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn btn-sm email-btn" href="mailto:?subject=Spread%20Spectrum%20Watermarking%20Lab&body=https%3a%2f%2fmelaniebrg.github.io%2fposts%2fdcp%2fwatermarking-lab%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/dcp/filtering-lab/ title="2D Image filtering Lab" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>2D Image filtering Lab</div></a></div><div class="col-md-6 next-article"><a href=/posts/dcp/blockchain-project/ title="Blockchain Application in Royalty Management for Digital Content Protection" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Blockchain Application in Royalty Management for Digital Content Protection</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#table-of-contents>Table of Contents</a></li></ul></li><li><a href=#off-the-shelf-random-number-generators>Off-the-Shelf Random Number Generators</a><ul><li><a href=#principles>Principles</a></li><li><a href=#uniform-distributed-generators>Uniform Distributed Generators</a></li><li><a href=#gaussian-distributed-generators>Gaussian Distributed Generators</a></li></ul></li><li><a href=#correlation-functions>Correlation Functions</a><ul><li><a href=#graphical-representation-and-properties>Graphical Representation and Properties</a><ul><li><a href=#temporal-autocorrelation-function>Temporal Autocorrelation Function</a></li></ul></li><li><a href=#cross-correlation-function>Cross Correlation Function</a></li><li><a href=#towards-cdma>Towards CDMA</a><ul><li><a href=#study-the-robustness-against-noise-addition>Study the robustness against noise addition</a></li></ul></li></ul></li><li><a href=#cdma-based-watermarking>CDMA based watermarking</a><ul><li><ul><li><a href=#detection-step>Detection step</a></li><li><a href=#robusteness-to-jpeg-compression>Robusteness to jpeg compression</a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#accomplishments>Accomplishments</a></li><li class=nav-item><a class=smooth-scroll href=https://melaniebrg.github.io#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:melanie.bregou92@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>melanie.bregou92@gmail.com</span></a></li><li><a href=https://github.com/MelanieBrg target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>MelanieBrg</span></a></li><li><a href=https://www.linkedin.com/in/M%c3%a9lanie%20Br%c3%a9gou target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Mélanie Brégou</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.f9b1238fc0c7166637cdbaef1b4f06db7267251fd3eb4faada4e24cab6164346.js integrity="sha256-+bEjj8DHFmY3zbrvG08G23JnJR/T60+q2k4kyrYWQ0Y=" defer></script></body></html>